(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/createOrder"],{"3b7f":function(t,e,o){"use strict";(function(t){o("f238");n(o("66fd"));var e=n(o("6fe1"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},4816:function(t,e,o){"use strict";var n;o.d(e,"b",(function(){return r})),o.d(e,"c",(function(){return i})),o.d(e,"a",(function(){return n}));var r=function(){var t=this,e=t.$createElement;t._self._c},i=[]},"6d4c":function(t,e,o){},"6fe1":function(t,e,o){"use strict";o.r(e);var n=o("4816"),r=o("993e");for(var i in r)"default"!==i&&function(t){o.d(e,t,(function(){return r[t]}))}(i);o("d4d0");var s,c=o("f0c5"),u=Object(c["a"])(r["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);e["default"]=u.exports},"93fe":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(){o.e("components/extend/button/button").then(function(){return resolve(o("1920"))}.bind(null,o)).catch(o.oe)},r=function(){o.e("components/list-cell/list-cell").then(function(){return resolve(o("80ca"))}.bind(null,o)).catch(o.oe)},i=function(){o.e("components/bottom-popup/bottom-popup").then(function(){return resolve(o("c417"))}.bind(null,o)).catch(o.oe)},s={components:{tuiButton:n,tuiListCell:r,tuiBottomPopup:i},data:function(){return{img_url:this.$img_url,maskState:0,hasCoupon:!1,is_pay_now:!1,total_cart_info:{},coupon_list:[],select_coupon_id:"",select_coupon_money:0,select_coupon_text:"选择优惠券",address:0,cart_info:{},priceGroup:{},cache_order_key:"",mark:"",order_id:0}},onLoad:function(e){var o=this,n=t.getStorageSync("order_cart_id");this.$api.CC_request.order_confirm(n).then((function(t){o.cart_info=t.cartInfo,o.address=t.addressInfo,o.cache_order_key=t.orderKey,o.total_Cart_info=t,o.coupon_list=t.usableCoupon,o.priceGroup.total_price=t.priceGroup.totalPrice,o.priceGroup.pay_postage=t.priceGroup.storePostage,o.priceGroup.pay_price=t.priceGroup.totalPrice,o.addAddress||null==o.address||o.compute_order_amount()}))},onShow:function(){},methods:{chooseAddr:function(){t.navigateTo({url:"../address/address?source=1"})},switchChange:function(t){this.is_pay_now=t.target.value},submit_order:function(){var e=this,o="";o=this.is_pay_now?"weixin":"offline",null!=this.address?this.$api.CC_request.order_create(this.cache_order_key,{payType:o,addressId:this.address.id,couponId:this.select_coupon_id,mark:this.mark,from:"routine"}).then((function(n){var r=n.result.orderId,i=n.result.jsConfig;e.order_id=r,"weixin"==o?e.pay(i):t.navigateTo({url:"/pages/order/success?order_id="+r})})):this.$api.msg("请选择收货地址")},compute_order_amount:function(){var t=this,e="";e=this.is_pay_now?"weixin":"offline",this.$api.CC_request.order_compute_amount(this.cache_order_key,{payType:e,addressId:this.address.id,couponId:this.select_coupon_id}).then((function(e){t.priceGroup=e.result}))},toggleMask:function(t){var e=this,o="show"===t?10:300,n="show"===t?1:0;this.maskState=2,setTimeout((function(){e.maskState=n}),o)},show_coupon:function(){this.maskState=1},to_use:function(t){this.maskState=0,this.select_coupon_id=this.coupon_list[t].id?this.coupon_list[t].id:0;var e=this.coupon_list[t].coupon_price;this.select_coupon_money=e,this.select_coupon_text="已优惠"+e+"元",this.compute_order_amount()},cancel_use:function(){this.maskState=0,this.select_coupon_id=0,this.select_coupon_money=0,this.select_coupon_text="选择优惠券",this.compute_order_amount()},pay:function(e){var o=this.order_id;t.requestPayment({provider:"wxpay",timeStamp:e.timestamp,nonceStr:e.nonceStr,package:e.package,signType:e.signType,paySign:e.paySign,success:function(e){t.navigateTo({url:"/pages/order/success?order_id="+o})},fail:function(e){t.redirectTo({url:"/pages/user/myorder/myorder?id="+o})}})}}};e.default=s}).call(this,o("543d")["default"])},"993e":function(t,e,o){"use strict";o.r(e);var n=o("93fe"),r=o.n(n);for(var i in n)"default"!==i&&function(t){o.d(e,t,(function(){return n[t]}))}(i);e["default"]=r.a},d4d0:function(t,e,o){"use strict";var n=o("6d4c"),r=o.n(n);r.a}},[["3b7f","common/runtime","common/vendor"]]]);